<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Photo Booth - Kitsch Frame</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      /* ğŸ”§ ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ì „ì²´ ë°°ê²½ ì´ë¯¸ì§€ ë³€ê²½ */
      --bg-image: url("https://images.pexels.com/photos/531880/pexels-photo-531880.jpeg?auto=compress&cs=tinysrgb&w=1200");
      --window-bg: rgba(255, 255, 255, 0.9);
      --accent-pink: #ff8ac2;
      --accent-mint: #9ef5d5;
      --accent-yellow: #ffe680;
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.2);
      --radius-xl: 24px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #111;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #222;
    }

    .app-bg {
      position: fixed;
      inset: 0;
      background-image: var(--bg-image);
      background-size: cover;
      background-position: center;
      filter: blur(6px) brightness(0.9);
      transform: scale(1.03);
      z-index: -1;
    }

    .photobooth-window {
      width: min(1100px, 95vw);
      height: min(680px, 90vh);
      background: var(--window-bg);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(18px);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* ===== ìƒë‹¨ ë°” ===== */
    .top-bar {
      height: 44px;
      display: flex;
      align-items: center;
      padding: 0 16px;
      background: linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(240,240,240,0.95));
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .window-controls {
      display: flex;
      gap: 6px;
      align-items: center;
      min-width: 90px;
    }

    .window-star {
      width: 16px; height: 16px;
      border-radius: 999px;
      display: flex; align-items: center; justify-content: center;
      font-size: 11px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.25);
      user-select: none;
    }
    .star-red { background:#ff5f57; color:#ffe5e3; }
    .star-yellow { background:#febc2e; color:#fff3d6; }
    .star-green { background:#28c840; color:#e1ffee; }

    .title {
      flex: 1;
      text-align: center;
      font-size: 14px;
      font-weight: 500;
      color:#555;
      letter-spacing: 0.03em;
    }

    .filter-toggle {
      border:none;
      background:white;
      border-radius:999px;
      width:32px;height:32px;
      display:inline-flex;align-items:center;justify-content:center;
      font-size:18px;
      cursor:pointer;
      box-shadow:0 4px 10px rgba(0,0,0,0.15);
      transition:transform .15s, box-shadow .15s, background-color .15s;
    }
    .filter-toggle:hover {
      transform:translateY(-1px);
      box-shadow:0 6px 16px rgba(0,0,0,0.2);
      background-color:#fff9fe;
    }
    .filter-toggle.active { background:var(--accent-pink); color:#fff; }

    /* ===== ì¤‘ì•™ ì˜ì—­ ===== */
    .content-row {
      flex:1;
      display:grid;
      grid-template-columns: minmax(0,1fr);
      padding:16px 16px 10px;
    }

    .preview-area {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }

    .preview-inner {
      position:relative;
      width:100%;
      max-width:720px;
      aspect-ratio:4 / 3;
      background: radial-gradient(circle at top left,#fef6ff,#f1f7ff 40%,#ddebf7 80%);
      border-radius:20px;
      overflow:hidden;
      box-shadow:0 14px 40px rgba(0,0,0,0.2);
      display:flex;
      align-items:center;
      justify-content:center;
      margin-inline:auto;
    }

    video, #photo {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
    }
    #photo { display:none; }

    /* í•„í„° íš¨ê³¼ */
    .preview-inner.filter-none   { filter:none; }
    .preview-inner.filter-soft   { filter:brightness(1.08) contrast(0.95) saturate(1.05); }
    .preview-inner.filter-pink   { filter:brightness(1.05) saturate(1.18) hue-rotate(-10deg); }
    .preview-inner.filter-film   { filter:contrast(1.15) saturate(0.95); }
    .preview-inner.filter-vintage{ filter:sepia(.3) contrast(1.05) saturate(.9); }
    .preview-inner.filter-mono   { filter:grayscale(1) contrast(1.1); }

    /* í”„ë ˆì„ ì˜¤ë²„ë ˆì´: PNG ê½‰ ì°¨ê²Œ */
    #frameOverlay {
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index:3;
      background-repeat:no-repeat;
      background-position:center;
      background-size:110% 110%; /* ì‚´ì§ í™•ëŒ€í•´ì„œ ì´ë¯¸ì§€ ë°”ê¹¥ ì—¬ë°± ì œê±° */
    }

    /* ğŸ”§ ì—¬ê¸°ì„œ ê° í”„ë ˆì„ PNG ì—°ê²° (images í´ë” ê¸°ì¤€) */
    .frame-1 { background-image:url("images/frame-1.png"); }
    .frame-2 { background-image:url("images/frame-2.png"); }
    .frame-3 { background-image:url("images/frame-3.png"); }
    .frame-4 { background-image:url("images/frame-4.png"); }
    .frame-5 { background-image:url("images/frame-5.png"); }
    .frame-6 { background-image:url("images/frame-6.png"); }

    /* ===== í”„ë ˆì„/í•„í„° íŠ¸ë ˆì´ ===== */
    .frame-toggle {
      margin-top:8px;
      border:none;
      width:34px;height:34px;
      border-radius:999px;
      background:#ffffff;
      display:flex;align-items:center;justify-content:center;
      font-size:16px;
      cursor:pointer;
      box-shadow:0 6px 16px rgba(0,0,0,0.2);
      transition:transform .15s, box-shadow .15s, background-color .15s;
    }
    .frame-toggle:hover {
      transform:translateY(-1px);
      box-shadow:0 8px 20px rgba(0,0,0,0.22);
      background-color:#fff7fd;
    }

    .frame-tray-wrapper {
      width:100%;
      max-width:720px;
      margin-top:6px;
      overflow:hidden;
      transition:max-height .25s ease;
      max-height:170px;          /* ê¸°ë³¸: ì—´ë¦¼ */
    }
    .frame-tray-wrapper.closed { max-height:0; }

    .frame-tray {
      background:rgba(255,255,255,0.96);
      border-radius:18px;
      box-shadow:0 10px 26px rgba(0,0,0,0.14);
      padding:8px 10px 10px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .tray-tabs {
      display:flex;
      gap:4px;
      padding-inline:4px;
    }
    .tray-tab {
      flex:1;
      border-radius:999px;
      border:none;
      padding:6px 0;
      font-size:12px;
      cursor:pointer;
      background:transparent;
      color:#777;
      transition:background-color .15s, color .15s;
    }
    .tray-tab.active {
      background:linear-gradient(135deg,#ff8ac2,#ffbfe0);
      color:#fff;
    }

    .tray-content {
      margin-top:4px;
    }

    .tray-panel { display:none; }
    .tray-panel.active { display:flex; }

    /* í”„ë ˆì„ ì¸ë„¤ì¼ */
    .frame-panel {
      gap:8px;
      overflow-x:auto;
    }
    .frame-thumb {
      flex:0 0 80px;
      height:70px;
      border-radius:14px;
      background:#f3f3f3;
      border:2px solid transparent;
      position:relative;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:11px;
      text-align:center;
      padding:4px;
      color:#555;
      transition:transform .12s, box-shadow .12s, border-color .12s, background-color .12s;
    }
    .frame-thumb::before {
      content:"";
      position:absolute;
      inset:8px;
      border-radius:10px;
      border:2px solid rgba(255,255,255,0.9);
      pointer-events:none;
    }
    .frame-thumb[data-frame="frame-1"] {
      background:linear-gradient(135deg,#ffb6d9,#ffe0f0);
    }
    .frame-thumb[data-frame="frame-2"] {
      background:linear-gradient(135deg,#b6ecff,#e5fbff);
    }
    .frame-thumb[data-frame="frame-3"] {
      background:linear-gradient(135deg,#ffffff,#f3f3f3);
    }
    .frame-thumb[data-frame="frame-4"] {
      background:linear-gradient(135deg,#ffe6b8,#fff4d0);
    }
    .frame-thumb[data-frame="frame-5"] {
      background:linear-gradient(135deg,#ffd5d5,#fff1f1);
    }
    .frame-thumb[data-frame="frame-6"] {
      background:linear-gradient(135deg,#ffb6ff,#b7f0ff);
    }
    .frame-thumb.active {
      border-color:var(--accent-pink);
      box-shadow:0 6px 14px rgba(0,0,0,0.18);
      transform:translateY(-2px);
    }

    /* í•„í„° ì¸ë„¤ì¼ (íŠ¸ë ˆì´ ì•ˆ) */
    .filter-panel {
      flex-wrap:wrap;
      gap:8px;
      justify-content:flex-start;
    }
    .filter-item {
      flex:0 0 calc(33.333% - 6px);
      border-radius:14px;
      background:#ffffff;
      border:1px solid rgba(0,0,0,0.05);
      padding:6px;
      box-shadow:0 4px 12px rgba(0,0,0,0.06);
      cursor:pointer;
      display:flex;
      flex-direction:column;
      gap:4px;
      transition:transform .12s, box-shadow .12s, border-color .12s, background-color .12s;
    }
    .filter-thumb {
      height:40px;
      border-radius:10px;
      background:linear-gradient(135deg,#ffe6f3,#e6f1ff);
    }
    .filter-name {
      font-size:11px;
      text-align:center;
      color:#555;
    }
    .filter-item.active {
      border-color:var(--accent-mint);
      background-color:#f6fffb;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
      transform:translateY(-2px);
    }

    /* ===== í•˜ë‹¨ ë°” ===== */
    .bottom-bar {
      padding:10px 24px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
    }

    .round-btn {
      border:none;
      border-radius:999px;
      padding:10px 18px;
      min-width:120px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
      font-size:14px;
      cursor:pointer;
      box-shadow:0 10px 24px rgba(0,0,0,0.18);
      background:#ffffff;
      transition:transform .12s, box-shadow .12s, background-color .12s;
    }
    .round-btn span.icon { font-size:16px; }

    .round-btn:hover {
      transform:translateY(-2px);
      box-shadow:0 14px 30px rgba(0,0,0,0.22);
      background-color:#fff7fd;
    }

    .round-btn.primary {
      background:linear-gradient(135deg,#ff8ac2,#ffb3d8);
      color:#fff;
    }
    .round-btn.primary:hover {
      background:linear-gradient(135deg,#ff7fbf,#ff9fd0);
    }

    .bottom-bar-left,.bottom-bar-right {
      flex:1;
      display:flex;
      justify-content:center;
    }
    .bottom-bar-left { justify-content:flex-start; }
    .bottom-bar-right{ justify-content:flex-end; }

    @media (max-width: 900px) {
      .preview-inner { max-width:100%; }
      .frame-tray-wrapper { max-width:100%; }
      .bottom-bar { flex-wrap:wrap; justify-content:center; }
      .round-btn { min-width:110px; padding-inline:14px; }
    }
  </style>
</head>
<body>
  <div class="app-bg"></div>

  <div class="photobooth-window">
    <!-- ìƒë‹¨ ë°” -->
    <header class="top-bar">
      <div class="window-controls">
        <div class="window-star star-red">â˜…</div>
        <div class="window-star star-yellow">â˜…</div>
        <div class="window-star star-green">â˜…</div>
      </div>
      <div class="title">Photo Booth</div>
      <button class="filter-toggle" id="filterToggle" aria-label="í•„í„° íƒ­ ì—´ê¸°">
        ğŸ¨
      </button>
    </header>

    <!-- ì¤‘ì•™ ì˜ì—­ -->
    <main class="content-row">
      <section class="preview-area">
        <div class="preview-inner filter-none" id="previewInner">
          <video id="cameraVideo" autoplay playsinline></video>
          <img id="photo" alt="ìº¡ì²˜ ì´ë¯¸ì§€" />
          <div id="frameOverlay" class="frame-1"></div>
        </div>

        <!-- íŠ¸ë ˆì´ í† ê¸€ ë²„íŠ¼ (âˆ§ / âˆ¨) -->
        <button id="frameToggle" class="frame-toggle" aria-expanded="true">
          âˆ§
        </button>

        <!-- í”„ë ˆì„/í•„í„° íŠ¸ë ˆì´ -->
        <div id="frameTrayWrapper" class="frame-tray-wrapper">
          <div class="frame-tray">
            <div class="tray-tabs">
              <button class="tray-tab active" id="tabFrames">í”„ë ˆì„</button>
              <button class="tray-tab" id="tabFilters">í•„í„°</button>
            </div>

            <div class="tray-content">
              <!-- í”„ë ˆì„ íŒ¨ë„ -->
              <div class="tray-panel frame-panel active" id="framePanel">
                <div class="frame-thumb active" data-frame="frame-1">í”„ë ˆì„ 1</div>
                <div class="frame-thumb" data-frame="frame-2">í”„ë ˆì„ 2</div>
                <div class="frame-thumb" data-frame="frame-3">í”„ë ˆì„ 3</div>
                <div class="frame-thumb" data-frame="frame-4">í”„ë ˆì„ 4</div>
                <div class="frame-thumb" data-frame="frame-5">í”„ë ˆì„ 5</div>
                <div class="frame-thumb" data-frame="frame-6">í”„ë ˆì„ 6</div>
              </div>

              <!-- í•„í„° íŒ¨ë„ -->
              <div class="tray-panel filter-panel" id="filterPanel">
                <div class="filter-item active" data-filter="filter-none">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">None</div>
                </div>
                <div class="filter-item" data-filter="filter-soft">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">Soft Cream</div>
                </div>
                <div class="filter-item" data-filter="filter-pink">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">Pink Mood</div>
                </div>
                <div class="filter-item" data-filter="filter-film">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">Film Dust</div>
                </div>
                <div class="filter-item" data-filter="filter-vintage">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">Vintage</div>
                </div>
                <div class="filter-item" data-filter="filter-mono">
                  <div class="filter-thumb"></div>
                  <div class="filter-name">Mono</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- í•˜ë‹¨ ë°” -->
    <footer class="bottom-bar">
      <div class="bottom-bar-left">
        <button class="round-btn" id="uploadBtn">
          <span class="icon">ğŸ“</span>
          <span>ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°</span>
        </button>
      </div>
      <div>
        <button class="round-btn primary" id="captureBtn">
          <span class="icon">ğŸ“¸</span>
          <span>ì‚¬ì§„ ì°ê¸°</span>
        </button>
      </div>
      <div class="bottom-bar-right">
        <button class="round-btn" id="shareBtn">
          <span class="icon">ğŸ”—</span>
          <span>ê³µìœ í•˜ê¸°</span>
        </button>
      </div>
      <input type="file" id="fileInput" accept="image/*" hidden />
    </footer>
  </div>

  <script>
    const video = document.getElementById("cameraVideo");
    const photo = document.getElementById("photo");
    const previewInner = document.getElementById("previewInner");
    const frameOverlay = document.getElementById("frameOverlay");

    const frameToggleBtn = document.getElementById("frameToggle");
    const frameTrayWrapper = document.getElementById("frameTrayWrapper");
    const frameThumbs = document.querySelectorAll(".frame-thumb");

    const tabFrames = document.getElementById("tabFrames");
    const tabFilters = document.getElementById("tabFilters");
    const framePanel = document.getElementById("framePanel");
    const filterPanel = document.getElementById("filterPanel");
    const filterItems = document.querySelectorAll(".filter-item");
    const filterToggle = document.getElementById("filterToggle");

    const uploadBtn = document.getElementById("uploadBtn");
    const captureBtn = document.getElementById("captureBtn");
    const shareBtn = document.getElementById("shareBtn");
    const fileInput = document.getElementById("fileInput");

    let stream = null;
    let isTrayOpen = true;

    // === ì¹´ë©”ë¼ ì‹œì‘ ===
    async function initCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: "user" },
          audio: false
        });
        video.srcObject = stream;
      } catch (err) {
        console.warn("ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨:", err);
        video.insertAdjacentHTML(
          "afterend",
          '<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:14px;color:#555;padding:16px;text-align:center;background:rgba(255,255,255,0.8);">ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br/>ì•„ë˜ [ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°] ë²„íŠ¼ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ ë³´ì„¸ìš”.</div>'
        );
      }
    }
    initCamera();

    // === íŠ¸ë ˆì´ ì—´ê³  ë‹«ê¸° (âˆ§ / âˆ¨) ===
    frameToggleBtn.addEventListener("click", () => {
      isTrayOpen = !isTrayOpen;
      if (isTrayOpen) {
        frameTrayWrapper.classList.remove("closed");
        frameToggleBtn.textContent = "âˆ§";
        frameToggleBtn.setAttribute("aria-expanded", "true");
      } else {
        frameTrayWrapper.classList.add("closed");
        frameToggleBtn.textContent = "âˆ¨";
        frameToggleBtn.setAttribute("aria-expanded", "false");
      }
    });

    // ìƒë‹¨ ğŸ¨ ë²„íŠ¼ â†’ íŠ¸ë ˆì´ ì—´ê³  í•„í„° íƒ­ìœ¼ë¡œ
    filterToggle.addEventListener("click", () => {
      if (!isTrayOpen) {
        frameTrayWrapper.classList.remove("closed");
        frameToggleBtn.textContent = "âˆ§";
        frameToggleBtn.setAttribute("aria-expanded", "true");
        isTrayOpen = true;
      }
      setActiveTab("filters");
      filterToggle.classList.add("active");
      setTimeout(() => filterToggle.classList.remove("active"), 300);
    });

    // === íƒ­ ì „í™˜ ===
    function setActiveTab(tab) {
      if (tab === "frames") {
        tabFrames.classList.add("active");
        tabFilters.classList.remove("active");
        framePanel.classList.add("active");
        filterPanel.classList.remove("active");
      } else {
        tabFrames.classList.remove("active");
        tabFilters.classList.add("active");
        framePanel.classList.remove("active");
        filterPanel.classList.add("active");
      }
    }

    tabFrames.addEventListener("click", () => setActiveTab("frames"));
    tabFilters.addEventListener("click", () => setActiveTab("filters"));

    // === í”„ë ˆì„ ì„ íƒ ===
    frameThumbs.forEach((thumb) => {
      thumb.addEventListener("click", () => {
        frameThumbs.forEach((t) => t.classList.remove("active"));
        thumb.classList.add("active");

        const frameName = thumb.dataset.frame;
        frameOverlay.className = "";
        frameOverlay.id = "frameOverlay";
        frameOverlay.classList.add(frameName);
      });
    });

    // === í•„í„° ì„ íƒ ===
    filterItems.forEach((item) => {
      item.addEventListener("click", () => {
        filterItems.forEach((f) => f.classList.remove("active"));
        item.classList.add("active");

        previewInner.classList.remove(
          "filter-none",
          "filter-soft",
          "filter-pink",
          "filter-film",
          "filter-vintage",
          "filter-mono"
        );
        const filterClass = item.dataset.filter;
        previewInner.classList.add(filterClass);
      });
    });

    // === ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸° ===
    uploadBtn.addEventListener("click", () => fileInput.click());

    fileInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (ev) => {
        photo.src = ev.target.result;
        photo.style.display = "block";
        video.style.display = "none";
      };
      reader.readAsDataURL(file);
    });

    // === ì‚¬ì§„ ì°ê¸° ===
    captureBtn.addEventListener("click", () => {
      if (!stream || video.readyState < 2) {
        alert("ì¹´ë©”ë¼ê°€ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì–´ìš”. ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¸ë‹¤ê°€ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        return;
      }
      const canvas = document.createElement("canvas");
      const w = video.videoWidth || 1280;
      const h = video.videoHeight || 720;
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(video, 0, 0, w, h);
      const dataUrl = canvas.toDataURL("image/png");
      photo.src = dataUrl;
      photo.style.display = "block";
      video.style.display = "none";
    });

    // === ê³µìœ í•˜ê¸° (ê°„ë‹¨ ë§í¬ ê³µìœ ) ===
    shareBtn.addEventListener("click", async () => {
      if (navigator.share) {
        try {
          await navigator.share({
            title: "Photo Booth",
            text: "í‚¤ì¹˜ í”„ë ˆì„ í¬í† ë¶€ìŠ¤ì—ì„œ ë§Œë“  ì‚¬ì§„ì´ì—ìš” âœ¨",
            url: window.location.href
          });
        } catch (err) {
          console.warn("ê³µìœ  ì·¨ì†Œ/ì‹¤íŒ¨:", err);
        }
      } else {
        alert("ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” Web Share APIë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ìš”.\nì£¼ì†Œì°½ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ì¹œêµ¬ì—ê²Œ ë³´ë‚´ ì£¼ì„¸ìš”!");
      }
    });
  </script>
</body>
</html>
